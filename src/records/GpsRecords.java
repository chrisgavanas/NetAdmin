package records;

import indexes.GpsIndex;

import java.io.File;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Scanner;

import Interfaces.GpsWrapper;

public class GpsRecords {
	// The data of the file gps.csv saved in indexes and lists//
	// ------------------------------------------------------------------------------------------------------------------------------------//
	private String filepath;
	private HashMap<String, GpsIndex> gpsrecords;
	private ArrayList<GpsWrapper> filerecs;

	// ------------------------------------------------------------------------------------------------------------------------------------//

	// ------------------------------------------------------------------------------------------------------------------------------------//
	public GpsRecords(String filepath) {
		setFilepath(filepath);
		setFilerecs(parse());
		gpsrecords = new HashMap<String, GpsIndex>();
	}

	// ------------------------------------------------------------------------------------------------------------------------------------//

	// ------------------------------------------------------------------------------------------------------------------------------------//
	// Parse the file and returned to a list of records//
	private ArrayList<GpsWrapper> parse() {
		ArrayList<GpsWrapper> lista = new ArrayList<GpsWrapper>();
		try {
			File file = new File(filepath);
			Scanner scan = new Scanner(file);
			scan.nextLine();
			while (scan.hasNextLine()) {
				String line = scan.nextLine();
				String[] parts = line.split("\t");
				lista.add(new GpsWrapper(parts[1],
						Double.parseDouble(parts[2]), Double
								.parseDouble(parts[3]), parts[4]));
			}
			scan.close();

		} catch (FileNotFoundException e) {
			e.printStackTrace();
		}
		return lista;
	}

	// ------------------------------------------------------------------------------------------------------------------------------------//

	// ------------------------------------------------------------------------------------------------------------------------------------//
	// Creates an index of the given key select if you want hashmap only
	// Navigable map only or both//
	public void createIndex(String key, boolean hm) {
		gpsrecords.put(key, new GpsIndex(key, filerecs, hm));
	}

	// ------------------------------------------------------------------------------------------------------------------------------------//

	// ------------------------------------------------------------------------------------------------------------------------------------//
	public GpsIndex getIndex(String key) {
		return gpsrecords.get(key);
	}

	// ------------------------------------------------------------------------------------------------------------------------------------//

	// ------------------------------------------------------------------------------------------------------------------------------------//
	public String getFilepath() {
		return filepath;
	}

	// ------------------------------------------------------------------------------------------------------------------------------------//

	// ------------------------------------------------------------------------------------------------------------------------------------//
	public void setFilepath(String filepath) {
		this.filepath = filepath;
	}

	// ------------------------------------------------------------------------------------------------------------------------------------//

	// ------------------------------------------------------------------------------------------------------------------------------------//
	public ArrayList<GpsWrapper> getFilerecs() {
		return filerecs;
	}

	// ------------------------------------------------------------------------------------------------------------------------------------//

	// ------------------------------------------------------------------------------------------------------------------------------------//
	public void setFilerecs(ArrayList<GpsWrapper> filerecs) {
		this.filerecs = filerecs;
	}

	// ------------------------------------------------------------------------------------------------------------------------------------//

	// ------------------------------------------------------------------------------------------------------------------------------------//
	public HashMap<String, GpsIndex> getGpsrecords() {
		return gpsrecords;
	}

	// ------------------------------------------------------------------------------------------------------------------------------------//

	// ------------------------------------------------------------------------------------------------------------------------------------//
	public void setGpsrecords(HashMap<String, GpsIndex> gpsrecords) {
		this.gpsrecords = gpsrecords;
	}
	// ------------------------------------------------------------------------------------------------------------------------------------//
}
